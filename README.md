# Cardiff Council Cycling IOT Web

This repository contains the code for the backend and web application for the Cardiff Council Cycling IOT project.

## Quick Start

### Prerequisites

To build this application, you'll need Node.JS installed with NPM (bundled with Node.JS). You can download them here:

[Download Node.JS and NPM](https://nodejs.org/en/)

To run the application, you will need MySQL to be installed an configured on your system with a database named `clean_air`. You can download MySQL here:
[Download MySQL](https://dev.mysql.com/downloads/windows/installer/)

This project also contains an editor config file. To use this with VS Code or Atom, you will need to install an extension. These extensions are available here:  

* [VS Code](https://marketplace.visualstudio.com/items?itemName=editorconfig.editorconfig)
* [Atom](https://atom.io/packages/editorconfig)

### Install and Run

Clone the repo  
```
git clone git@gitlab.cs.cf.ac.uk:c1630757/cardiff-council-cycling-iot-web.git
```

Create a config.json file in the config folder  
_If you don't create a configuration file, the default configuration will be used_
```
{
  "host": "localhost",
  "user": "root",
  "password": "password",
  "database": "clean_air"
}
```

Install with NPM  
```
npm install
```

Build and run the applcation  
```
npm run buildRun
```

View the application in your browser at [http://localhost:3000/](http://localhost:3000/)

## Commands

The following NPM scripts are included in the project. For the commands that build or start the project, you can specify the environment with `:prod` or `:dev`.  

* **Start**  
  Runs the application on port 3000.  
  `npm run start`

* **Build**  
  Runs webpack to build the client-side Javascript.  
  `npm run build`  

* **Watch**  
  Runs webpack to build the client-side Javascript, watching for changes.  
  `npm run watch`  

* **Build and Run**  
  Runs webpack to build the client-side Javascript and starts the app, watching for changes.  
  `npm run buildRun`

* **Test**  
  Runs Jest to test the code.  
  `npm run test`

* **Linting**  
  Runs ESLint to lint both the client and server-side code. Use `:fix` to attempt to automatically apply fixes.  
  `npm run lint`  

## Tools and Config

* **React**  
  Used for the creating the interface.

* **Express**  
  Used for the web server.

* **Socket IO**  
  Used for implementing web-sockets in the application.

* **Editor Config**  
  Sets editor settings for supported editors.  
  May require a plugin for some editors, including Atom and VS Code.  
  Configured in `.editorconfig`

* **ES Lint**  
  Used for Javascript linting.  
  Configured in `package.json` and with `.eslintignore`.

* **Webpack**  
  Used for running build tasks.  
  Configured with the webpack files in the config folder.

* **Babel**  
  JS compiler for client-side code.  
  Configured in `package.json`.

* **Jest**  
  Used for testing.  
  Configured in `package.json`.

* **Enzyme**  
  Used for improved testing of React components.  
  Configured in `config/jest/jestSetup.js`

## Project Structure

* **Client**  
  Contains the client-side code to be compiled with Webpack and Babel.

* **Public**  
  Contains static files that will be hosted by the server, including the compiled Javascript generated by Webpack.

* **Server**  
  Contains the server-side code, including index.js, which is executed with `npm run start` to run the application.

* **Config**  
  Contains Webpack and Jest config files.

## Tests

Testing files for React components are named with `.spec.js` and are located in the same directory as the component being tested. Jest will automatically find files with this extension when running the `npm run test` command.
